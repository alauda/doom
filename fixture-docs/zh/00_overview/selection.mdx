---
weight: 40
---

# 应用及工作负载选型

## 应用选型

目前平台提供了 OAM 应用、原生应用、模板应用、组件应用五种类型的应用，每一种应用都有其适用的场景，另外平台也提供了 GitOps 的管理方式，因此需要实际环境并根据不同维度进行应用的选型，选型流程如下：

1. 若存在历史遗产（包袱、社区、开源），则选择目前正在使用的应用类型。

   - 包袱： 目前项目使用历史遗留的技术、决策或代码。

   - 社区： 目前的项目受到社区的文化和决策方式或项目早期历史的影响。

   - 开源： 存在一些开源方面的历史遗产，它们对项目的当前状态产生了影响。

2. 若不存在历史遗产，则可根据如下内容进行选型。其中，❌ 代表不需要；✅ 代表需要或允许；⭐️ 代表技能或成本的要求高低，星号越多则表示需要的技能或成本越高，您可以根据实际情况，按需选择。

   | 参考维度                     | 原生应用     | 模板应用  | OAM 应用  | Operator 应用 | GitOps 应用     |
   | ---------------------------- | ------------ | --------- | --------- | ------------- | --------------- |
   | 业务应用复杂度               | 简单         | 复杂      | 复杂      | 复杂          | -               |
   | 对 Kubernetes 专业技能的要求 | ⭐️⭐️⭐️⭐️ | ⭐️⭐️    | ⭐️       | ⭐️           | ⭐️⭐️⭐️⭐️    |
   | 开发成本                     | ⭐️          | ⭐️⭐️    | ⭐️⭐️⭐️ | ⭐️⭐️⭐️⭐️  | -               |
   | 运维成本                     | ⭐️⭐️⭐️⭐️ | ⭐️⭐️⭐️ | ⭐️⭐️    | ⭐️           | ⭐️⭐️⭐️⭐️⭐️ |
   | 是否需要做业务容灾           | ❌           | ❌        | ❌        | ❌            | ✅              |
   | 是否允许为第三方客户提供能力 | ❌           | ✅        | ✅        | ✅            | ❌              |
   | 是否需要独立的平台开发团队   | ❌           | ✅        | ✅        | ✅            | ❌              |

   **参考维度说明**：

   - **业务应用复杂度**：应用中计算组件的数量，计算组件数量越多则越复杂。

   - **对 Kubernetes 专业技能的要求**：对于 Kubernetes 中各种概念及技术的掌握程度。
   - **是否需要做业务容灾**：是否有必要为业务设置容灾（发生灾难性事件，例如自然灾害、硬件故障、网络故障等问题时，能够维持业务运行的能力）。
   - **是否允许为第三方客户提供能力**：是否允许用户通过 Helm Chart 或 Operator 封装自己的应用并提供给第三方客户使用。

## 工作负载选型

平台提供了 Deployment、DaemonSet、StatefulSet、Job、CronJob 五种工作负载，每一种工作负载都有其适用的场景，因此需要选择合适的工作负载。但在实际应用中，可能需要组合使用多种工作负载来构建完整的应用系统。例如，一个完整的应用可能包含：

- 使用 Deployment 部署前端和后端服务
- 使用 StatefulSet 部署数据库
- 使用 DaemonSet 部署日志收集组件
- 使用 CronJob 执行定时备份任务

| 工作负载类型    | 特点                                                                                                                          | 选型建议                                                                                         |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| **Deployment**  | <ul><li>支持水平扩缩容</li><li>支持滚动更新和回滚</li><li>Pod 名称随机，重启后会变化</li><li>适合并行处理请求的场景</li></ul> | 如果是无状态的应用（如 Web 服务、API 服务、前端应用、微服务应用），优先选择此类型。              |
| **DaemonSet**   | <ul><li>每个节点运行一个 Pod</li><li>新节点自动部署 Pod</li><li>节点移除时自动清理 Pod</li><li>支持选择特定节点部署</li></ul> | 如果需要在每个节点上都运行（如日志收集、监控采集、存储服务、网络插件），选择此类型。             |
| **StatefulSet** | <ul><li>Pod 名称固定且有序</li><li>提供稳定的网络标识</li><li>支持持久化存储</li><li>按顺序进行部署和扩缩容</li></ul>         | 如果应用需要固定的网络标识或持久化存储（如数据库、分布式缓存、消息队列、搜索引擎），选择此类型。 |
| **Job**         | <ul><li>确保任务成功完成</li><li>支持并行运行多个 Pod</li><li>任务完成后自动清理</li><li>可设置重试次数</li></ul>             | 如果是一次性执行的任务（如数据迁移、文件处理、批量计算、发送邮件），选择此类型。                 |
| **CronJob**     | <ul><li>按时间计划运行 Job</li><li>支持 Cron 表达式</li><li>可配置任务历史保留策略</li><li>可暂停和恢复调度</li></ul>         | 如果是需要周期性执行的任务（如数据备份、报表生成、清理任务、定时通知），选择此类型。             |
